{% extends 'base.html' %}
{% load static %}
{% block meta %}
<title>Create Product - Absolute Sports</title>
{% endblock meta %}

{% block content %}
{% include 'navbar.html' %}
<div class="bg-gray-900 w-full pt-16 min-h-screen">
  <div class="max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Back Navigation -->
    <div class="mb-6">
      <a href="{% url 'main:show_main' %}" class="text-gray-400 hover:text-white font-medium transition-colors">
        ‚Üê Back to Products
      </a>
    </div>
    
    <!-- Form Card -->
    <div class="bg-gray-800 rounded-lg border border-gray-700 shadow-xl overflow-hidden">
      <!-- Header -->
      <div class="p-6 border-b border-gray-700">
        <h1 class="text-2xl font-bold text-white mb-2">Create New Product</h1>
        <p class="text-gray-400">Sell your football products to the community</p>
      </div>
      
      <!-- Body -->
      <form method="POST" class="p-6 space-y-5">
        {% csrf_token %}
        
        <div>
          <label for="name" class="block text-sm font-medium text-gray-300">Product Name</label>
          <input type="text" id="name" name="name" required
                 class="mt-2 w-full rounded-md bg-gray-900 border border-gray-700 px-3 py-2 text-gray-100 placeholder-gray-500 focus:ring-2 focus:ring-purple-600 focus:outline-none"
                 placeholder="Enter product name"
                 value="{{ form.name.value|default:'' }}">
          {% for error in form.name.errors %}
            <p class="mt-1 text-sm text-red-500">{{ error }}</p>
          {% endfor %}
        </div>

        <div>
          <label for="description" class="block text-sm font-medium text-gray-300">Description</label>
          <textarea id="description" name="description" rows="4" required
                    class="mt-2 w-full rounded-md bg-gray-900 border border-gray-700 px-3 py-2 text-gray-100 placeholder-gray-500 focus:ring-2 focus:ring-purple-600 focus:outline-none"
                    placeholder="Describe your product">{{ form.description.value|default:'' }}</textarea>
          {% for error in form.description.errors %}
            <p class="mt-1 text-sm text-red-500">{{ error }}</p>
          {% endfor %}
        </div>

        <div>
          <label for="price" class="block text-sm font-medium text-gray-300">Price (Rp)</label>
          <input type="number" id="price" name="price" required
                 class="mt-2 w-full rounded-md bg-gray-900 border border-gray-700 px-3 py-2 text-gray-100 placeholder-gray-500 focus:ring-2 focus:ring-purple-600 focus:outline-none"
                 placeholder="Enter price"
                 value="{{ form.price.value|default:'' }}">
          {% for error in form.price.errors %}
            <p class="mt-1 text-sm text-red-500">{{ error }}</p>
          {% endfor %}
        </div>

        <div>
          <label for="category" class="block text-sm font-medium text-gray-300">Category</label>
          <select id="category" name="category" required
                  class="mt-2 w-full rounded-md bg-gray-900 border border-gray-700 px-3 py-2 text-gray-100 focus:ring-2 focus:ring-purple-600 focus:outline-none">
            <option value="">Select category</option>
            <option value="football" {% if form.category.value == 'football' %}selected{% endif %}>Football</option>
            <option value="socks" {% if form.category.value == 'socks' %}selected{% endif %}>Socks</option>
            <option value="jersey" {% if form.category.value == 'jersey' %}selected{% endif %}>Jersey</option>
            <option value="shoes" {% if form.category.value == 'shoes' %}selected{% endif %}>Shoes</option>
            <option value="knee guard" {% if form.category.value == 'knee guard' %}selected{% endif %}>Knee Guard</option>
          </select>
          {% for error in form.category.errors %}
            <p class="mt-1 text-sm text-red-500">{{ error }}</p>
          {% endfor %}
        </div>

        <div>
          <label for="thumbnail" class="block text-sm font-medium text-gray-300">Thumbnail URL</label>
          <input type="url" id="thumbnail" name="thumbnail"
                 class="mt-2 w-full rounded-md bg-gray-900 border border-gray-700 px-3 py-2 text-gray-100 placeholder-gray-500 focus:ring-2 focus:ring-purple-600 focus:outline-none"
                 placeholder="https://example.com/image.jpg"
                 value="{{ form.thumbnail.value|default:'' }}">
          {% for error in form.thumbnail.errors %}
            <p class="mt-1 text-sm text-red-500">{{ error }}</p>
          {% endfor %}
        </div>

        <div class="flex items-center space-x-2">
          <input type="checkbox" id="is_featured" name="is_featured" 
                 class="w-4 h-4 text-purple-600 bg-gray-800 border-gray-600 rounded focus:ring-purple-500"
                 {% if form.is_featured.value %}checked{% endif %}>
          <label for="is_featured" class="text-sm text-gray-300">Featured Product</label>
          {% for error in form.is_featured.errors %}
            <p class="mt-1 text-sm text-red-500">{{ error }}</p>
          {% endfor %}
        </div>

        <!-- Form Actions -->
        <div class="flex flex-col sm:flex-row gap-4 pt-6 border-t border-gray-700">
          <a href="{% url 'main:show_main' %}" 
             class="order-2 sm:order-1 px-6 py-3 border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700 transition-all text-center">
            Cancel
          </a>
          <button type="submit" 
                  class="order-1 sm:order-2 flex-1 bg-purple-600 text-white px-6 py-3 rounded-md font-medium hover:bg-purple-700 transition-colors">
            Publish Product
          </button>
        </div>
      </form>
    </div>
  </div>
</div>


<script>
// Form validation and user feedback
document.querySelector('form').addEventListener('submit', function(e) {
    const form = e.target;
    const requiredFields = form.querySelectorAll('[required]');
    let isValid = true;
    
    // Check required fields
    requiredFields.forEach(field => {
        if (!field.value.trim()) {
            isValid = false;
            field.classList.add('border-red-500');
        } else {
            field.classList.remove('border-red-500');
        }
    });
    
    // Price validation
    const priceField = form.querySelector('#price');
    if (priceField.value && parseInt(priceField.value) < 0) {
        isValid = false;
        priceField.classList.add('border-red-500');
        showErrorToast('Invalid Price', 'Price cannot be negative.');
        e.preventDefault();
        return;
    }
    
    if (!isValid) {
        showErrorToast('Missing Information', 'Please fill in all required fields.');
        e.preventDefault();
        return;
    }
    
    // Show loading toast
    showInfoToast('Creating Product', 'Please wait while we create your product...');
});

// Clear error styling on input
document.querySelectorAll('input, select, textarea').forEach(field => {
    field.addEventListener('input', function() {
        this.classList.remove('border-red-500');
    });
});

// Preview image URL
document.querySelector('#thumbnail').addEventListener('blur', function() {
    const url = this.value;
    if (url) {
        // Simple URL validation
        try {
            new URL(url);
            showInfoToast('Image URL Added', 'Thumbnail will be displayed on your product card.');
        } catch (e) {
            showWarningToast('Invalid URL', 'Please enter a valid image URL.');
        }
    }
});

// Category change feedback
document.querySelector('#category').addEventListener('change', function() {
    if (this.value) {
        showInfoToast('Category Selected', `Your product will be listed under ${this.options[this.selectedIndex].text}.`);
    }
});
</script>

{% endblock %}
